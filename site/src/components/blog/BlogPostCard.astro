---
/**
 * BlogPostCard
 * Displays a summary of a blog post for listing pages.
 */

// Type imports
import type { CollectionEntry } from 'astro:content';
import { Image } from 'astro:assets';

// Props interface with JSDoc comments
interface Props {
  /** The blog post entry from Astro content collections */
  post: CollectionEntry<'blog'>;
}

// Destructure with defaults
const { post } = Astro.props;

// Format date
const formattedDate = post.data.pubDate.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});
---

<article class="bg-white rounded-lg shadow-md overflow-hidden h-full flex flex-col transition-all duration-300 ease-in-out
                hover:shadow-lg hover:-translate-y-1 group
                focus-within:ring-2 focus-within:ring-primary focus-within:ring-offset-2 focus-within:ring-offset-background">
  {post.data.image && (
    <div class="relative w-full h-48 overflow-hidden">
      <Image
        src={post.data.image.url}
        alt={post.data.image.alt}
        widths={[300, 600, 900]}
        sizes="(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw"
        class="w-full h-full object-cover transition-transform duration-500 ease-in-out group-hover:scale-105"
        loading="lazy"
        decoding="async"
      />
    </div>
  )}
  <div class="p-6 flex flex-col flex-grow">
    <time datetime={post.data.pubDate.toISOString()} class="text-sm text-neutral-500 font-body mb-2">
      {formattedDate}
    </time>
    <h2 class="text-xl font-heading font-semibold text-neutral-800 mb-3 flex-grow">
      <a href={`/blog/${post.slug}`} class="hover:text-primary transition-colors duration-200 ease-in-out focus:outline-none">
        {post.data.title}
      </a>
    </h2>
    <p class="text-neutral-500 font-body text-base line-clamp-3 mb-4">
      {post.data.description}
    </p>
    <div class="flex flex-wrap gap-2 mt-auto">
      {post.data.tags.map((tag) => (
        <a
          href={`/blog?category=${tag}`}
          class="text-xs bg-neutral-100 text-neutral-600 px-3 py-1 rounded-full hover:bg-neutral-200 transition-colors duration-200 ease-in-out
                 focus:outline-none focus-visible:ring-1 focus-visible:ring-primary"
          aria-label={`View posts in ${tag} category`}
        >
          #{tag}
        </a>
      ))}
    </div>
  </div>
</article>

<style>
  /* Reduced motion preference */
  @media (prefers-reduced-motion: reduce) {
    article {
      transition: none;
    }
    img {
      transition: none;
    }
    a {
      transition: none;
    }
  }
</style>